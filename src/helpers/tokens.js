'use strict'
if(process.env.NODE_ENV === 'develop') require('dotenv').config()
const jwt = require( 'jsonwebtoken' )
const RSA_PVK = '2d2d2d2d2d424547494e2050524956415445204b45592d2d2d2d2d0a4d49494a524149424144414e42676b71686b69473977304241514546414153434353347767676b7141674541416f494341514431594d6a5363796336753959420a68504f386d3276467972775757613779794530794235533252766c744d5a726452785a3167517442654457742b486478646361536e4e503779616d5250384d310a64464d544d626264304e5a47302f42595366356772654f326d34743349366876537943326255696f414e596870306449433831544a374f65345a5854454f79700a37316f444e7831566e5a466e505979384239503374734839623571566e2f6c66424d51674769724561486f4a67397678696744446a5036656e4c47324c69496b0a6c39614c38494330484b49612b44574b346f56647a6a4e5259532b6c4644504e494e543867466935597031416d5963636144646e4c443379503232757654446c0a552b516f414f79614f6359633563726d53682b6848702f2f4e393162595a342b676378676339692b2b50336c506e4b4b72775577434b4a552f443838665647790a58374f326d3030564851757368375a4c3176455a375970346b714661422f4b526b784a797a6a6b5047647a314c416a2b53514d42454d46495747645a38662b350a35553047344e474a626f59496d6162506c794d622b4c6b7433713363706b30486434464c4f516672425274363565316b75363230687a4b7272577345694f326c0a744d70696a5572425533436b3444574f514b71584c743354654a49746d715a4d5a5444434c755877657358786b3242425833796e45673058526d4c69655958330a4a517a4e4a4e343552734c384d505a4d334c38772b6d556b494668686f59613448776275656634725151786279525330592b764f78474978795341694f6d48660a434a533845776f50423867504550714d764f5a2b6f37796634747a435265696e70715161456a4e797a766d50546c6834694b746e6b62376c6641592f703145340a4e4c386a4a336c79665563786366765970686f45614439664d466f725951494441514142416f49434151446f594f5575734a4535525550786f6d6831654c63430a315046314e532f43697344596e5764506a4432524649593241716d5a564546466d6b4d7a3433657967726777687363577a36392f642b51317a6c6b53643256590a416675376a65457971376830394a6b50695a54316d6c5a634e386a6547766251374348654d783446632b2f6154574946474677635441336c445743775a4e53710a4452507a73733243454f50443131633133536948684c33554a35355a544936742f4d642b4656734a44776d554b415847546c7a615443785866566859704d59750a54474f5571505744397577596e7a766f574f4b584d6c2b775a75527430467132446c63674934565a2b4c526e522f584f5968564d67363033735641454e6f50620a747455513775704e563274473263727146347a526973776a4a436461504c764b642b467935635878347268462b68644a357130346176496776424e6b3377534b0a4849553371716a6b797243704f4472637949394f33557642674a3356544c3837616337684274627556464b34447279705478494b56433974636c78686b4b722f0a446159764e64625949434a6830714f37733464766562695a5655696b5466646a6f4745576545562b62484548494a707871306b596141776831323330714675680a723064433332326536794e6d7374793850642b536c515171716753326d6c62736767754b45424156327a7a7871444d5a4a68614547596c326a3536416c41756b0a39534e4d4138466e42637a443954554e634b5364725976306457625a534949526777565341396f354b4a6e6135444e5a76584d78556b375630675077315079380a6c7966764e6771516652494b6659683133676b2b586637793956744b4d7a73385a426e376c434d4e72656e455148432f736959364549396b35566f7a396e59640a78636845624d50425268376b78317853693948724d514b43415145412b725a4452355036636b422b5757377946647954654d57645641496f5557727357396b6c0a4a3232476d7732776f436a7848394f33317a563857306e645779497a3948426e716e623867536f72484e612f724e734759474f575636614355757130376e504c0a6f666c356d38724d614b75416f376b5741686763504e2b535547482f4657794968704a684b433639487069332f5736376956524833565934484978525054796f0a694758766f2f3253756537316e75494752796632366f68705853476d74522f663436506b4364586e77495a61677254474b4b446256737437724c7658433049620a4f514a727a3755444b57536c6a3766756a6e48434f664a73536b386639364f613474664f35647a313847515530556d6f6249684769355341314b72384f354d420a306432575277726572524f4b53515378313272544679594b2b454e6b4478786b774453764c3243424a684d316243686d46514b43415145412b6f3234693137620a79596879495472645a4b726f5a33585a30336767634263325a6f4d6247656c64744964614948746d7a52626f6e5a662f733833366742585a764c4f67544979690a667a49644658337a667642465764417a3346496c737276667652724c495765473630364e446a4d32637174365644616e57484a525a75422b483446394a6d73370a4e79755a475374563830712b6355516f395a63494a4b5930772b6f35534c556a3175342f774958344e46426a306a426c304e4167654a48323236496a2f352b420a5731644c4167384e587061737a7365725a312f6a4c5a44426a54665348333262766662624d446563692b6e794370553149714f4a6a6868624b4f4e7a6433782f0a52516c783778616479764e756a716b442f315a3267516c4764727436524d784946447562534e4a4778413962784a5742384b76614d7837396377657866766b6b0a4562537274567a685a64587648514b43415145416d5a51673771333155787579796e497546627044464535707139614f674346786e476f4f576e4b37624377630a73462b6b4a597a364a766a3672716b3230656248304d73796c6266427768586b7877753936744e5975703847723761755373444143506f69475a7a4c492b59390a42546c5a32664539544263633553564861626f2b47672b634b6d4e73354d4b4d307a74574b676331466c44736e4f642b412b376f72517946614e69597a656f390a675779695261764c6b4c636f694537377a444d612f6755436a31344d43514a68727777655563635052454156584c76566a4f4363514b64454b633454344f37500a6577484f635a57497176574174794b4c74354630306177453630537231783965414e3474366d366d6e36567a49586e6332576e4d6a576e6d5358726c336173490a38526a784d7632504f356953717247424d7365466563513436347a6161376c41492b544d6175377361514b43415145416b5a524d3250583534495265512f364f0a3674482f44545a467059435434473073563633767a6b4e7842646272514270545a6644636f637a536275664d6d4357614350475a763043726e6870424764362f0a3330362b444f78545a623135562f75666961494b79744c376172654f622b54447979626c6767377264784764534a68423041364e364166414e564d6f747034650a5a366c544e443631536456436a77446667634954484c4c624b795074655043656763372f345033722b734d6a5373734d307872487264784137684376625866500a66646b7765556b3878326a49654134323139584b53692f536b544c67736f6874646b49744e346277673772667a75644a2b463049467a4949524e577a464964670a6b6136563232424c43553530746f3773475572665253416f39564359376c763363433234565758465256436c444c5542384a6455773445424f795274374967570a4576535635514b43415142505a4331334777767132674649614c752b4e454158746b627771726d4d684f45562b4b4c6570354c75383955614a59527341706a440a36527779447759636a32747154344f632f4e592b2f5a6d5953437a534e714469562f77714c4b47574a4c497665464f5a5543424f41636d2f77637763415a54310a304d75544348316b656b63584e62365148453967334f503463785a5856634d3951544a373553684f622f4d4168585534396946566b4d466f71594f504d6567650a626d624d5279695a33532f6f56527553504f534c6d4f65353858764a766f54334c51427170685675574948437549386261476863646551716362473139794f670a2b4678504b2b5a37655455502f3951596d615076692b4e706139477247473549582f78724854636c6d6e6b34536863713033593664354f4854764f42737769570a52645a4342412b742b55435a564d7865336f4b6e4250436636762b572f70517a0a2d2d2d2d2d454e442050524956415445204b45592d2d2d2d2d0a'
const RSA_PBK = '2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494943496a414e42676b71686b6947397730424151454641414f43416738414d49494343674b434167454139574449306e4d6e4f7276574159547a764a74720a78637138466c6d753873684e4d676555746b623562544761335563576459454c5158673172666833635858476b707a542b386d706b542f444e585254457a47320a336444575274507757456e2b594b336a7470754c64794f6f62307367746d314971414457496164485341764e5579657a6e7547563078447371653961417a63640a565a32525a7a324d76416654393762422f572b616c5a2f355877544549426f71784768364359506238596f4177347a2b6e707978746934694a4a6657692f43410a744279694776673169754b465863347a555745767052517a7a5344552f49425975574b64514a6d48484767335a797739386a3974727230773556506b4b4144730a6d6a6e47484f584b356b6f666f5236662f7a666457324765506f484d5948505976766a3935543579697138464d4169695650772f50483152736c2b7a7470744e0a4652304c72496532533962784765324b654a4b68576766796b5a4d536373343544786e63395377492f6b6b44415244425346686e5766482f7565564e427544520a69573647434a6d6d7a35636a472f69354c643674334b5a4e42336542537a6b4836775562657558745a4c7574744963797136317242496a747062544b596f314b0a77564e77704f41316a6b43716c793764303369534c5a716d544755777769376c38487246385a4e67515639387078494e46305a69346e6d463979554d7a5354650a4f5562432f444432544e792f4d50706c4a4342595961474775423847376e6e2b4b30454d57386b55744750727a7352694d636b67496a70683377695576424d4b0a44776649447844366a4c7a6d66714f386e2b4c63776b586f7036616b4768497a637337356a303559654969725a35472b35587747503664524f44532f497964350a636e31484d584837324b59614247672f587a42614b3245434177454141513d3d0a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a'

const generateToken = payload =>
    jwt.sign(
        payload,
        Buffer.from(process.env.RSA_PVK, 'hex').toString('utf-8'),
        { algorithm: 'RS256', expiresIn: '24h' }
    )

const verifyToken = payload =>
    jwt.verify(
        payload,
        Buffer.from(process.env.RSA_PBK, 'hex').toString('utf-8'),
        { algorithm: ['RS256'] }
    )

module.exports = { generateToken, verifyToken }
